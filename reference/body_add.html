<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add content into a Word document — body_add • officer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add content into a Word document — body_add"><meta name="description" content="This function adds objects into a Word document. Values are added
as new paragraphs or tables.
This function is experimental and will replace the body_add_* functions
later. For now it is only to be used for successive additions and cannot
be used in conjunction with the body_add_* functions."><meta property="og:description" content="This function adds objects into a Word document. Values are added
as new paragraphs or tables.
This function is experimental and will replace the body_add_* functions
later. For now it is only to be used for successive additions and cannot
be used in conjunction with the body_add_* functions."><meta property="og:image" content="https://davidgohel.github.io/officer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">officer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ardata-fr.github.io/officeverse/">User Documentation</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidgohel/officer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add content into a Word document</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidgohel/officer/blob/master/R/docx_add.R" class="external-link"><code>R/docx_add.R</code></a></small>
      <div class="d-none name"><code>body_add.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adds objects into a Word document. Values are added
as new paragraphs or tables.</p>
<p>This function is experimental and will replace the <code>body_add_*</code> functions
later. For now it is only to be used for successive additions and cannot
be used in conjunction with the <code>body_add_*</code> functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'character'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'numeric'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, format_fun <span class="op">=</span> <span class="va">formatC</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'factor'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, format_fun <span class="op">=</span> <span class="va">as.character</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'fpar'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tcf <span class="op">=</span> <span class="fu"><a href="table_conditional_formatting.html">table_conditional_formatting</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alignment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'block_caption'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'block_list'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'block_toc'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'external_img'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="st">"Normal"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'run_pagebreak'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'run_columnbreak'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, style <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gg'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'plot_instr'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'block_pour_docx'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'block_section'</span></span>
<span><span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an rdocx object</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>object to add in the document. Supported objects
are vectors, data.frame, graphics, block of formatted paragraphs,
unordered list of formatted paragraphs,
pretty tables with package flextable, 'Microsoft' charts with package mschart.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods. When
adding a <code>ggplot</code> object or <a href="plot_instr.html">plot_instr</a>, these arguments will be used
by png function. See method signatures to see what arguments can be used.</p></dd>


<dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>paragraph style name. These names are available with function <a href="styles_info.html">styles_info</a>
and are the names of the Word styles defined in the base document (see
argument <code>path</code> from <a href="read_docx.html">read_docx</a>).</p></dd>


<dt id="arg-format-fun">format_fun<a class="anchor" aria-label="anchor" href="#arg-format-fun"></a></dt>
<dd><p>a function to be used to format values.</p></dd>


<dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>display header if TRUE</p></dd>


<dt id="arg-tcf">tcf<a class="anchor" aria-label="anchor" href="#arg-tcf"></a></dt>
<dd><p>conditional formatting settings defined by <code><a href="table_conditional_formatting.html">table_conditional_formatting()</a></code></p></dd>


<dt id="arg-alignment">alignment<a class="anchor" aria-label="anchor" href="#arg-alignment"></a></dt>
<dd><p>columns alignement, argument length must match with columns length,
values must be "l" (left), "r" (right) or "c" (center).</p></dd>


<dt id="arg-width-height">width, height<a class="anchor" aria-label="anchor" href="#arg-width-height"></a></dt>
<dd><p>plot size in units expressed by the unit argument.
Defaults to a width of 6 and a height of 5 "in"ches.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>resolution of the png image in ppi</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Multiplicative scaling factor, same as in ggsave</p></dd>


<dt id="arg-unit">unit<a class="anchor" aria-label="anchor" href="#arg-unit"></a></dt>
<dd><p>One of the following units in which the width and height
arguments are expressed: "in", "cm" or "mm".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>

<ul><li><p><code>body_add(character)</code>: add a character vector.</p></li>
<li><p><code>body_add(numeric)</code>: add a numeric vector.</p></li>
<li><p><code>body_add(factor)</code>: add a factor vector.</p></li>
<li><p><code>body_add(fpar)</code>: add a <a href="fpar.html">fpar</a> object. These objects enable
the creation of formatted paragraphs made of formatted chunks of text.</p></li>
<li><p><code>body_add(data.frame)</code>: add a data.frame object with <code><a href="block_table.html">block_table()</a></code>.</p></li>
<li><p><code>body_add(block_caption)</code>: add a <a href="block_caption.html">block_caption</a> object. These objects enable
the creation of set of formatted paragraphs made of formatted chunks of text.</p></li>
<li><p><code>body_add(block_list)</code>: add a <a href="block_list.html">block_list</a> object. Use this function
to add a list of block elements (e.g. paragraphs, images, tables)
into a Word document in a more efficient way than with usual
<code>body_add_*</code> functions. This function will add several elements
in a faster way because the cursor is not calculated for
each iteraction over the elements, as a consequence the
function only append elements at the end of the document
and does not allow to insert elements at a specific position.</p></li>
<li><p><code>body_add(block_toc)</code>: add a table of content (a <a href="block_toc.html">block_toc</a> object).</p></li>
<li><p><code>body_add(external_img)</code>: add an image (a <a href="external_img.html">external_img</a> object).</p></li>
<li><p><code>body_add(run_pagebreak)</code>: add a <a href="run_pagebreak.html">run_pagebreak</a> object.</p></li>
<li><p><code>body_add(run_columnbreak)</code>: add a <a href="run_columnbreak.html">run_columnbreak</a> object.</p></li>
<li><p><code>body_add(gg)</code>: add a ggplot object.</p></li>
<li><p><code>body_add(plot_instr)</code>: add a base plot with a <a href="plot_instr.html">plot_instr</a> object.</p></li>
<li><p><code>body_add(block_pour_docx)</code>: pour content of an external docx file with with a <a href="block_pour_docx.html">block_pour_docx</a> object</p></li>
<li><p><code>body_add(block_section)</code>: ends a section with a <a href="block_section.html">block_section</a> object</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="illustrations">Illustrations<a class="anchor" aria-label="anchor" href="#illustrations"></a></h2>



<p><img src="figures/body_add_doc_1.png" style="width:70%;"></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This example demonstrates the versatility of body_add()</span></span></span>
<span class="r-in"><span><span class="co"># by showing how to add various content types to a Word document</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a new Word document</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_docx.html">read_docx</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a heading for the table of contents section</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="st">"Table of content"</span>, style <span class="op">=</span> <span class="st">"heading 1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Insert an automatic table of contents</span></span></span>
<span class="r-in"><span><span class="co"># This will list all headings in the document</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="block_toc.html">block_toc</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Insert a page break to start content on a new page</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="run_pagebreak.html">run_pagebreak</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a main section heading</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="st">"Iris Dataset Sample"</span>, style <span class="op">=</span> <span class="st">"heading 1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a data.frame as a table</span></span></span>
<span class="r-in"><span><span class="co"># The first 6 rows of the iris dataset will be displayed</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"table_template"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add another section heading</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="st">"Alphabetic List"</span>, style <span class="op">=</span> <span class="st">"heading 1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a character vector as paragraphs</span></span></span>
<span class="r-in"><span><span class="co"># Each letter will appear as a separate paragraph with "Normal" style</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="va">letters</span>, style <span class="op">=</span> <span class="st">"Normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Insert a continuous section break</span></span></span>
<span class="r-in"><span><span class="co"># Content continues on the same page but section properties can change</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="block_section.html">block_section</a></span><span class="op">(</span><span class="fu"><a href="prop_section.html">prop_section</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a plot created with R base graphics</span></span></span>
<span class="r-in"><span><span class="co"># plot_instr() captures the plotting code to generate the image</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="plot_instr.html">plot_instr</a></span><span class="op">(</span>code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change to landscape orientation for the next section</span></span></span>
<span class="r-in"><span><span class="co"># This creates a new section with landscape page layout</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_add</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="block_section.html">block_section</a></span><span class="op">(</span><span class="fu"><a href="prop_section.html">prop_section</a></span><span class="op">(</span>page_size <span class="op">=</span> <span class="fu"><a href="page_size.html">page_size</a></span><span class="op">(</span>orient <span class="op">=</span> <span class="st">"landscape"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Save the document to a file</span></span></span>
<span class="r-in"><span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".docx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, target <span class="op">=</span> <span class="va">output_file</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>proudly brought to you by <a href="https://www.ardata.fr" class="external-link"><img alt="ardata" src="https://www.ardata.fr/img/ardata-logo.svg" width="70"></a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

