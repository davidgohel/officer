<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import an external docx in a 'Word' document — body_import_docx • officer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import an external docx in a 'Word' document — body_import_docx"><meta name="description" content="Import body content and footnotes of a Word document into an rdocx object.
The function is similar to body_add_docx() but instead of adding
the content as an external object, the document is read and all its
content is appended to the target document."><meta property="og:description" content="Import body content and footnotes of a Word document into an rdocx object.
The function is similar to body_add_docx() but instead of adding
the content as an external object, the document is read and all its
content is appended to the target document."><meta property="og:image" content="https://davidgohel.github.io/officer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">officer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ardata-fr.github.io/officeverse/">User Documentation</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidgohel/officer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import an external docx in a 'Word' document</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidgohel/officer/blob/master/R/docx_add.R" class="external-link"><code>R/docx_add.R</code></a></small>
      <div class="d-none name"><code>body_import_docx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import body content and footnotes of a Word document into an rdocx object.</p>
<p>The function is similar to <code><a href="body_add_docx.html">body_add_docx()</a></code> but instead of adding
the content as an external object, the document is read and all its
content is appended to the target document.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">body_import_docx</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">src</span>,</span>
<span>  par_style_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  run_style_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  tbl_style_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prepend_chunks_on_styles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an rdocx object</p></dd>


<dt id="arg-src">src<a class="anchor" aria-label="anchor" href="#arg-src"></a></dt>
<dd><p>path to docx file to import</p></dd>


<dt id="arg-par-style-mapping-run-style-mapping-tbl-style-mapping">par_style_mapping, run_style_mapping, tbl_style_mapping<a class="anchor" aria-label="anchor" href="#arg-par-style-mapping-run-style-mapping-tbl-style-mapping"></a></dt>
<dd><p>Named lists describing how to remap styles from the source document (<code>src</code>)
to styles available in the target document <code>x</code>. For each list entry, the name
of the element is the target style (in <code>x</code>), and the value is a character
vector of style names from the source document that should be replaced by
this target style.</p><ul><li><p><code>par_style_mapping</code>: applies to paragraph styles.</p></li>
<li><p><code>run_style_mapping</code>: applies to character (run) styles.</p></li>
<li><p><code>tbl_style_mapping</code>: applies to table styles.</p></li>
</ul><p>Examples:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">par_style_mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Normal"</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"List Paragraph"</span>, <span class="st">"Body Text"</span><span class="op">)</span>,</span>
<span>  <span class="st">"heading 1"</span> <span class="op">=</span> <span class="st">"Heading 1"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">run_style_mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Emphasis"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Emphasis"</span>, <span class="st">"Italic"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tbl_style_mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Normal Table"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Light Shading"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>Use <code><a href="styles_info.html">styles_info()</a></code> to inspect available styles and verify their names.</p></dd>


<dt id="arg-prepend-chunks-on-styles">prepend_chunks_on_styles<a class="anchor" aria-label="anchor" href="#arg-prepend-chunks-on-styles"></a></dt>
<dd><p>A named list of run chunks to prepend
to runs with specific styles. The names of the list are paragraph style names
and the values run chunks to prepend. The first motivation for this argument
is to allow prepending of runs in paragraphs with a defined style, for example
to add a <code><a href="run_autonum.html">run_autonum()</a></code> with all image captions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The following operations are performed when importing a document:</p><ul><li><p>Numbering are copied from the source document to the target document.</p></li>
<li><p>Styles are not copied. If styles in the source document do not exist
in the target document, the style specified in the <code>par_style_mapping</code>,
<code>run_style_mapping</code> and <code>tbl_style_mapping</code> arguments will be used instead.
If no mapping is provided, the default style will be used and a warning is emitted.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for adding content:
<code><a href="body_add_blocks.html">body_add_blocks</a>()</code>,
<code><a href="body_add_break.html">body_add_break</a>()</code>,
<code><a href="body_add_caption.html">body_add_caption</a>()</code>,
<code><a href="body_add_docx.html">body_add_docx</a>()</code>,
<code><a href="body_add_fpar.html">body_add_fpar</a>()</code>,
<code><a href="body_add_gg.html">body_add_gg</a>()</code>,
<code><a href="body_add_img.html">body_add_img</a>()</code>,
<code><a href="body_add_par.html">body_add_par</a>()</code>,
<code><a href="body_add_plot.html">body_add_plot</a>()</code>,
<code><a href="body_add_table.html">body_add_table</a>()</code>,
<code><a href="body_add_toc.html">body_add_toc</a>()</code>,
<code><a href="body_append_context.html">body_append_start_context</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/officeverse/" class="external-link">officer</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example file from the package</span></span></span>
<span class="r-in"><span><span class="va">file_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"officer"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"doc_examples/example.docx"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a new rdocx document</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_docx.html">read_docx</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import content from file_input</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">body_import_docx</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  src <span class="op">=</span> <span class="va">file_input</span>,</span></span>
<span class="r-in"><span>  <span class="co"># style mapping for paragraphs and tables</span></span></span>
<span class="r-in"><span>  par_style_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Normal"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"List Paragraph"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  tbl_style_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Normal Table"</span> <span class="op">=</span> <span class="st">"Light Shading"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create temporary file</span></span></span>
<span class="r-in"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".docx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># write to file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, target <span class="op">=</span> <span class="va">tf</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>proudly brought to you by <a href="https://www.ardata.fr" class="external-link"><img alt="ardata" src="https://www.ardata.fr/img/ardata-logo.svg" width="70"></a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

