<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Replace text anywhere in the document, or at a cursor — body_replace_all_text • officer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Replace text anywhere in the document, or at a cursor — body_replace_all_text" />
<meta property="og:description" content="Replace all occurrences of old_value with new_value. This method
uses grepl/gsub for pattern matching; you may
supply arguments as required (and therefore use regex features)
using the optional ... argument.
Note that by default, grepl/gsub will use fixed=FALSE, which means
that old_value and new_value will be interepreted as regular
expressions.
Chunking of text
Note that the behind-the-scenes representation of text in a Word document is
frequently not what you might expect! Sometimes a paragraph of text is broken
up (or &quot;chunked&quot;) into several &quot;runs,&quot; as a result of style changes, pauses
in text entry, later revisions and edits, etc. If you have not styled the
text, and have entered it in an &quot;all-at-once&quot; fashion, e.g. by pasting it or
by outputing it programmatically into your Word document, then this will
likely not be a problem. If you are working with a manually-edited document,
however, this can lead to unexpected failures to find text.
You can use the officer function docx_show_chunk to
show how the paragraph of text at the current cursor has been chunked into
runs, and what text is in each chunk. This can help troubleshoot unexpected
failures to find text." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">officer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.15.008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://ardata-fr.github.io/officeverse/">Documentation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidgohel/officer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Replace text anywhere in the document, or at a cursor</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidgohel/officer/blob/master/R/docx_replace.R'><code>R/docx_replace.R</code></a></small>
    <div class="hidden name"><code>body_replace_all_text.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Replace all occurrences of old_value with new_value. This method
uses <code><a href='https://rdrr.io/r/base/grep.html'>grepl</a></code>/<code><a href='https://rdrr.io/r/base/grep.html'>gsub</a></code> for pattern matching; you may
supply arguments as required (and therefore use <code><a href='https://rdrr.io/r/base/regex.html'>regex</a></code> features)
using the optional <code>...</code> argument.</p>
<p>Note that by default, grepl/gsub will use <code>fixed=FALSE</code>, which means
that <code>old_value</code> and <code>new_value</code> will be interepreted as regular
expressions.</p>
<p><strong>Chunking of text</strong></p>
<p>Note that the behind-the-scenes representation of text in a Word document is
frequently not what you might expect! Sometimes a paragraph of text is broken
up (or "chunked") into several "runs," as a result of style changes, pauses
in text entry, later revisions and edits, etc. If you have not styled the
text, and have entered it in an "all-at-once" fashion, e.g. by pasting it or
by outputing it programmatically into your Word document, then this will
likely not be a problem. If you are working with a manually-edited document,
however, this can lead to unexpected failures to find text.</p>
<p>You can use the officer function <code><a href='docx_show_chunk.html'>docx_show_chunk</a></code> to
show how the paragraph of text at the current cursor has been chunked into
runs, and what text is in each chunk. This can help troubleshoot unexpected
failures to find text.</p>
    </div>

    <pre class="usage"><span class='fu'>body_replace_all_text</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>old_value</span>,
  <span class='va'>new_value</span>,
  only_at_cursor <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>headers_replace_all_text</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>old_value</span>,
  <span class='va'>new_value</span>,
  only_at_cursor <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>footers_replace_all_text</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>old_value</span>,
  <span class='va'>new_value</span>,
  only_at_cursor <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a docx device</p></td>
    </tr>
    <tr>
      <th>old_value</th>
      <td><p>the value to replace</p></td>
    </tr>
    <tr>
      <th>new_value</th>
      <td><p>the value to replace it with</p></td>
    </tr>
    <tr>
      <th>only_at_cursor</th>
      <td><p>if <code>TRUE</code>, only search-and-replace at the current
cursor; if <code>FALSE</code> (default), search-and-replace in the entire document
(this can be slow on large documents!)</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>warn if <code>old_value</code> could not be found.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments to grepl/gsub (e.g. <code>fixed=TRUE</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="header-replace-all-text"><a class="anchor" href="#header-replace-all-text"></a>header_replace_all_text</h2>

    

<p>Replacements will be performed in each header of all sections.</p>

<p>Replacements will be performed in each footer of all sections.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/grep.html'>grep</a></code>, <code><a href='https://rdrr.io/r/base/regex.html'>regex</a></code>, <code><a href='docx_show_chunk.html'>docx_show_chunk</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Frank Hangler, <a href='mailto:frank@plotandscatter.com'>frank@plotandscatter.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>magrittr</span><span class='op'>)</span>

<span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read_docx.html'>read_docx</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='body_add_par.html'>body_add_par</a></span><span class='op'>(</span><span class='st'>"Placeholder one"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='body_add_par.html'>body_add_par</a></span><span class='op'>(</span><span class='st'>"Placeholder two"</span><span class='op'>)</span>

<span class='co'># Show text chunk at cursor</span>
<span class='fu'><a href='docx_show_chunk.html'>docx_show_chunk</a></span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span>  <span class='co'># Output is 'Placeholder two'</span>
</div><div class='output co'>#&gt; <span class='message'>1 text nodes found at this cursor. </span>
#&gt; <span class='message'>  &lt;w:t&gt;: 'Placeholder two'</span></div><div class='input'>
<span class='co'># Simple search-and-replace at current cursor, with regex turned off</span>
<span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'>body_replace_all_text</span><span class='op'>(</span><span class='va'>doc</span>, old_value <span class='op'>=</span> <span class='st'>"Placeholder"</span>,
  new_value <span class='op'>=</span> <span class='st'>"new"</span>, only_at_cursor <span class='op'>=</span> <span class='cn'>TRUE</span>, fixed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='docx_show_chunk.html'>docx_show_chunk</a></span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span>  <span class='co'># Output is 'new two'</span>
</div><div class='output co'>#&gt; <span class='message'>1 text nodes found at this cursor. </span>
#&gt; <span class='message'>  &lt;w:t&gt;: 'new two'</span></div><div class='input'>
<span class='co'># Do the same, but in the entire document and ignoring case</span>
<span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'>body_replace_all_text</span><span class='op'>(</span><span class='va'>doc</span>, old_value <span class='op'>=</span> <span class='st'>"placeholder"</span>,
  new_value <span class='op'>=</span> <span class='st'>"new"</span>, only_at_cursor<span class='op'>=</span><span class='cn'>FALSE</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='cursor_begin.html'>cursor_backward</a></span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span>
<span class='fu'><a href='docx_show_chunk.html'>docx_show_chunk</a></span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span> <span class='co'># Output is 'new one'</span>
</div><div class='output co'>#&gt; <span class='message'>1 text nodes found at this cursor. </span>
#&gt; <span class='message'>  &lt;w:t&gt;: 'new one'</span></div><div class='input'>
<span class='co'># Use regex : replace all words starting with "n" with the word "example"</span>
<span class='va'>doc</span> <span class='op'>&lt;-</span> <span class='fu'>body_replace_all_text</span><span class='op'>(</span><span class='va'>doc</span>, <span class='st'>"\\bn.*?\\b"</span>, <span class='st'>"example"</span><span class='op'>)</span>
<span class='fu'><a href='docx_show_chunk.html'>docx_show_chunk</a></span><span class='op'>(</span><span class='va'>doc</span><span class='op'>)</span> <span class='co'># Output is 'example one'</span>
</div><div class='output co'>#&gt; <span class='message'>1 text nodes found at this cursor. </span>
#&gt; <span class='message'>  &lt;w:t&gt;: 'example one'</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <link href="../ardata.css" rel="stylesheet">
<div class="author">
  <p>Version&nbsp;0.3.15.008 - Developed by David Gohel - proudly brought to you by <a href="http://www.ardata.fr"><img alt="ardata" src='../ardata-logo.svg' style="vertical-align:middle;height:24px;"/></a>
  </p>
</div>
<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48354045-1', 'auto');
  ga('send', 'pageview');
</script>

      </footer>
   </div>

  


  </body>
</html>


